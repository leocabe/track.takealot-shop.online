<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tracking Order</title>

<style>

body{margin:0;font-family:Arial;}
.container{max-width:390px;margin:auto;padding:12px;}

.topbar{text-align:center;margin-top:5px;}
.topbar img{height:34px;}

h2{text-align:center;margin:8px 0;}

.track-box{display:flex;gap:6px;margin:12px 0;}
.track-box input{flex:1;padding:9px;}
.track-box button{
background:#0088d8;color:#fff;border:none;
padding:9px 12px;font-weight:bold;cursor:pointer;
}

.loading{display:none;text-align:center;color:#0088d8;font-weight:bold;margin:10px 0;}

.timeline{position:relative;margin-left:90px;}
.timeline::before{
content:"";position:absolute;left:8px;top:0;
width:10px;height:100%;background:#ddd;border-radius:20px;
}

.progress{
position:absolute;left:8px;top:0;
width:10px;height:80px;
background:#0b88d8;border-radius:20px;
transition:0.5s;
}

.item{position:relative;margin-bottom:45px;}
.date{position:absolute;left:-90px;font-size:12px;color:#777;}

.circle{
position:absolute;left:3px;
width:20px;height:20px;
background:#fff;border-radius:50%;
border:4px solid #0b88d8;
}

.gray .circle{border-color:#bbb;}
.content{margin-left:40px;}

.stock-orange{color:#ff8c00;font-weight:bold;}
.green{color:#46b64b;font-weight:bold;}

.hidden{display:none;}

.update{
background:#f2f2f2;
padding:10px;
margin-top:12px;
font-weight:bold;
font-size:14px;
}

.stock-warning{
margin-top:8px;
background:#fff3cd;
padding:10px;
border-radius:6px;
font-weight:bold;
color:#856404;
font-size:14px;
}

</style>
</head>

<body>

<div class="container">

<div class="topbar">
<img src="logo-takealot.svg">
</div>

<h2>Tracking</h2>

<div class="track-box">
<input type="text" id="code" placeholder="Transaction ID">
<button onclick="trackOrder()">TRACK ORDER</button>
</div>

<div class="loading" id="loading">Loading tracking information...</div>

<div class="timeline">

<div class="progress" id="progress"></div>

<div class="item">
<div class="date" id="date1"></div>
<div class="circle"></div>
<div class="content"><h3>Order Paid</h3></div>
</div>

<div id="extraSteps" class="hidden">

<div class="item gray" id="step2">
<div class="date" id="date2"></div>
<div class="circle"></div>
<div class="content">
<h3>Shipped</h3>
<p>üì¶ POINTEKX RHINO X21 ‚Äì Pro Tool Combo 100X</p>
<p class="stock-orange">Waiting stock replenishment (7 days)</p>
</div>
</div>

<div class="item gray" id="step3">
<div class="date" id="date3"></div>
<div class="circle"></div>
<div class="content"><h3>üöö OUT FOR DELIVERY</h3></div>
</div>

<div class="item gray" id="step4">
<div class="date" id="date4"></div>
<div class="circle"></div>
<div class="content">
<h3 class="green" id="deliveryTitle">DELIVERY SCHEDULED</h3>
<span id="clock"></span>
</div>
</div>

</div>

</div>

<div class="update hidden" id="update"></div>

<div class="stock-warning hidden" id="stockWarning">
‚ö†Ô∏è Due to stock shortage, delivery may take up to 7 days.<br>
Estimated delivery: <span id="estimatedDate"></span>
</div>

</div>

<script>

/* ===== FUN√á√ïES ===== */

function formatDate(d){
return d.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}).toUpperCase();
}

function saveTracking(code){
localStorage.setItem("tracking_"+code, Date.now());
}

function loadTracking(code){
let start = localStorage.getItem("tracking_"+code);
if(!start) return null;
return new Date(parseInt(start));
}

function showTracking(){
extraSteps.classList.remove("hidden");
update.classList.remove("hidden");
stockWarning.classList.remove("hidden");
}

/* ===== LOGICA REAL ===== */

function updateTimeline(startDate){

let today = new Date();

let shippedDate = new Date(startDate);
shippedDate.setDate(shippedDate.getDate()+7);

let outDate = new Date(startDate);
outDate.setDate(outDate.getDate()+8);

let deliveryDate = new Date(startDate);
deliveryDate.setDate(deliveryDate.getDate()+9);

date1.innerText=formatDate(startDate);
date2.innerText=formatDate(shippedDate);
date3.innerText=formatDate(outDate);
date4.innerText=formatDate(deliveryDate);

estimatedDate.innerText=formatDate(deliveryDate);
update.innerText="Latest Update: "+formatDate(today);

let days=Math.floor((today-startDate)/(1000*60*60*24));

progress.style.height="80px";

if(days>=7){
step2.classList.remove("gray");
progress.style.height="140px";
}

if(days>=8){
step3.classList.remove("gray");
progress.style.height="200px";
}

/* ===== CONTADOR ENTREGA ===== */

let diff = deliveryDate - today;

if(diff>0){

let totalMinutes=Math.floor(diff/1000/60);
let d=Math.floor(totalMinutes/(60*24));
let h=Math.floor((totalMinutes-(d*60*24))/60);
let m=totalMinutes%60;

deliveryTitle.innerText =
`DELIVERY IN ${d} DAYS ${h}H ${m}M`;

}else{

step4.classList.remove("gray");
progress.style.height="270px";
deliveryTitle.innerText="DELIVERY TODAY BEFORE 17H00";

}

}

/* ===== TRACK ===== */

function trackOrder(){

let code=document.getElementById("code").value;

if(code===""){
alert("Insira o c√≥digo");
return;
}

loading.style.display="block";

setTimeout(()=>{

loading.style.display="none";

let saved=loadTracking(code);

if(!saved){
saveTracking(code);
saved=loadTracking(code);
}

showTracking();
updateTimeline(saved);

/* atualiza contador autom√°tico */
setInterval(()=>{ updateTimeline(saved); },60000);

},1500);

}

/* rel√≥gio */
setInterval(()=>{
clock.innerText=new Date().toLocaleTimeString();
},1000);

</script>

</body>
</html>

